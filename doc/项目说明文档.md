# 智能专注助手 - 项目说明文档

## 1. 项目概述

智能专注助手是一个基于多模态情境感知的智能系统，旨在帮助用户在不同场景下维持专注状态并保护用户隐私。该系统通过监测环境、应用程序和用户状态等多维度信息，构建动态的专注上下文模型，实现从"显式命令-执行"到"隐式感知-推理-服务"的交互范式转变。

### 1.1 核心交互理念

- **核心问题**：用户在日常工作和学习中需要主动、显式地管理自己的专注状态和隐私边界，如手动暂停视频、切换窗口或调节音量，这可能导致分心、效率低下甚至社交尴尬。

- **解决方案**：设计一个智能助手，通过融合环境、应用程序和用户状态信息，自动执行符合用户当前专注目标和社交礼仪的操作。

- **交互模型**：隐式情境-服务适配模型，系统通过持续的情境感知，自动提供相应服务，实现"无感"的人机协奏。

### 1.2 项目目标

实现任务2中定义的三个基础功能部件的整合：
1. 音量监控助手 - 检测音量并在适当情况下暂停媒体播放
2. 快捷键控制器 - 提供全局快捷键操作功能
3. 文档自动保存助手 - 快速保存当前活动文档

## 2. 设计需求分析

### 2.1 功能需求

#### 2.1.1 音量监控助手
- 检测系统音量状态
- 识别媒体播放活动
- 当检测到音量不为0且有媒体播放时自动暂停并提示用户
- 提供退出功能

#### 2.1.2 快捷键控制器
- 提供全局快捷键监听
- 支持按A键暂停/播放视频
- 支持按B键切换到上一个窗口
- 提供退出功能

#### 2.1.3 文档自动保存助手
- 提供全局快捷键监听
- 支持按A键保存当前活动文档
- 识别不同类型的应用程序并使用相应的保存方法
- 提供退出功能

#### 2.1.4 智能助手整合界面
- 提供功能选择界面
- 支持单独或同时启动各个功能模块
- 显示系统状态和操作反馈
- 提供统一的退出机制

### 2.2 非功能需求

- **用户体验**：界面简洁直观，操作响应迅速
- **可靠性**：系统应稳定运行，避免崩溃或误操作
- **兼容性**：支持常见的Windows应用程序
- **性能**：低资源占用，不影响系统性能
- **可扩展性**：模块化设计，便于后续功能扩展

## 3. 系统架构设计

### 3.1 整体架构

智能专注助手采用模块化架构设计，主要包含以下几个核心部分：

1. **整合界面层**：由`smart_assistant.py`实现，提供用户交互界面，负责启动、管理和协调各个功能模块
2. **功能模块层**：包含三个独立的功能组件
   - `volume_monitor.py`：音量监控功能
   - `hotkey_controller.py`：快捷键控制功能
   - `document_saver.py`：文档保存功能
3. **系统交互层**：使用各种第三方库与操作系统进行交互
   - pyautogui：模拟键盘鼠标操作
   - pynput：监听全局键盘事件
   - win32gui/win32process：获取窗口信息和进程信息
   - psutil：获取系统进程信息
   - pycaw：控制音频设备

### 3.2 模块关系

```
smart_assistant.py
   ├── volume_monitor.py
   ├── hotkey_controller.py
   └── document_saver.py
```

每个功能模块都是独立的应用程序，可以单独运行，也可以通过`smart_assistant.py`统一管理。这种设计实现了高内聚、低耦合的系统架构，便于单独开发、测试和维护各个模块。

## 4. 核心功能模块详解

### 4.1 智能助手整合界面 (SmartAssistantApp)

#### 4.1.1 功能描述

智能助手整合界面是整个系统的入口，提供图形用户界面，允许用户选择需要启动的功能模块。它负责创建、管理和终止各个功能模块的进程。

#### 4.1.2 核心组件

- **GUI界面**：使用Tkinter构建，包含功能选择复选框、控制按钮和状态显示
- **进程管理**：负责启动和停止各个功能模块的子进程
- **依赖检查**：在启动时检查必要的Python库是否已安装

#### 4.1.3 关键方法

- `start_all_functions()`：启动所有功能模块
- `start_selected_functions()`：启动选中的功能模块
- `stop_all_functions()`：停止所有功能模块
- `start_script(script_name)`：启动指定的Python脚本

### 4.2 音量监控助手 (VolumeMonitorApp)

#### 4.2.1 功能描述

音量监控助手负责检测系统音量状态和媒体播放活动，当检测到音量不为0且有媒体播放时，自动暂停媒体并显示提示信息。

#### 4.2.2 核心组件

- **音量检测**：使用pycaw库获取系统音量状态
- **媒体播放检测**：通过检查系统音频会话和进程来判断是否有媒体在播放
- **全局键盘监听**：监听Q键以退出程序
- **提示弹窗**：在检测到需要暂停媒体时显示提示

#### 4.2.3 关键方法

- `get_system_volume()`：获取系统音量状态
- `is_media_playing()`：检查是否有媒体在播放
- `monitor_volume()`：定期监控音量和媒体播放状态
- `set_system_mute()`：设置系统静音
- `show_volume_warning()`：显示音量警告弹窗

### 4.3 快捷键控制器 (HotkeyControllerApp)

#### 4.3.1 功能描述

快捷键控制器提供全局快捷键监听功能，使用户可以通过简单的按键操作控制视频播放和窗口切换。

#### 4.3.2 核心组件

- **全局键盘监听**：使用pynput库监听全局键盘事件
- **操作执行**：使用pyautogui执行键盘快捷键操作
- **操作冷却机制**：防止频繁操作

#### 4.3.3 关键方法

- `on_key_press(key)`：处理键盘按键事件
- `pause_video()`：暂停或播放视频
- `switch_window()`：切换到上一个窗口
- `is_cooldown_over(operation_name)`：检查操作冷却时间

### 4.4 文档自动保存助手 (DocumentSaverApp)

#### 4.4.1 功能描述

文档自动保存助手允许用户通过快捷键快速保存当前活动文档，支持各种常见的文档编辑应用程序。

#### 4.4.2 核心组件

- **全局键盘监听**：使用pynput库监听全局键盘事件
- **窗口信息获取**：获取当前活动窗口的标题和进程信息
- **应用程序识别**：识别是否为文档类应用程序
- **保存操作执行**：发送保存快捷键到当前活动窗口

#### 4.4.3 关键方法

- `on_key_press(key)`：处理键盘按键事件
- `get_active_window_info()`：获取当前活动窗口信息
- `is_document_application(process_name)`：检查是否为文档类应用程序
- `save_current_document()`：保存当前活动文档
- `is_cooldown_over()`：检查操作冷却时间

## 5. 核心流程说明

### 5.1 系统启动流程

1. 用户启动`smart_assistant.py`
2. 系统检查必要的Python库依赖
3. 显示功能选择界面
4. 用户选择需要启动的功能模块
5. 系统启动相应的子进程
6. 各功能模块开始独立运行

### 5.2 音量监控流程

1. `VolumeMonitorApp`启动音量监控线程
2. 定期检查系统音量状态
3. 检查是否有媒体在播放
4. 如果音量不为0且有媒体播放，则执行以下操作：
   - 暂停媒体播放
   - 显示警告弹窗
   - 设置系统静音
5. 继续监控音量状态

### 5.3 快捷键操作流程

1. 全局键盘监听器检测到按键事件
2. 根据按下的键执行相应操作：
   - A键：暂停视频或保存文档
   - B键：切换窗口
   - Q键：退出程序
3. 执行操作前检查冷却时间
4. 执行相应的键盘快捷键或操作
5. 更新状态显示

## 6. 技术栈和依赖

### 6.1 主要技术栈

- **开发语言**：Python 3.x
- **GUI框架**：Tkinter
- **系统交互**：pyautogui, pynput, win32gui, win32process, psutil
- **音频控制**：pycaw, pygame

### 6.2 依赖项

- tkinter：图形用户界面库
- pynput：键盘监听
- pyautogui：自动化操作
- psutil：进程和系统监控
- pygame：音频处理
- win32gui/win32process：Windows API调用
- pycaw：音频控制

## 7. 使用说明

### 7.1 安装依赖

在运行程序前，请确保已安装以下Python库：

```
pip install pyautogui pynput psutil pygame pycaw pywin32
```

### 7.2 启动程序

1. 导航到项目目录
2. 执行以下命令启动智能专注助手：
   ```
   python smart_assistant.py
   ```

### 7.3 功能使用

#### 7.3.1 智能助手整合界面

- 选择需要启动的功能模块
- 点击"启动选中功能"或"启动全部功能"
- 点击"停止所有功能"可以停止已启动的功能
- 点击"退出程序"退出智能助手

#### 7.3.2 音量监控助手

- 程序会自动监控系统音量和媒体播放状态
- 当检测到音量不为0且有媒体播放时，会自动暂停并显示提示
- 按Q键退出音量监控助手

#### 7.3.3 快捷键控制器

- 按A键：暂停/播放视频
- 按B键：切换到上一个窗口
- 按Q键：退出快捷键控制器

#### 7.3.4 文档自动保存助手

- 按A键：保存当前活动文档
- 按Q键：退出文档自动保存助手

## 8. 未来扩展建议

### 8.1 功能扩展

- **环境感知增强**：添加摄像头支持，实现用户表情识别和周围人数检测
- **智能模式切换**：根据用户行为和环境自动切换工作/休闲模式
- **多用户支持**：添加用户配置文件，支持不同用户的个性化设置
- **通知管理**：根据当前专注状态智能管理系统通知

### 8.2 技术优化

- **性能优化**：减少资源占用，提高响应速度
- **稳定性提升**：增强错误处理和异常恢复机制
- **跨平台支持**：扩展到macOS和Linux平台
- **模块化重构**：采用更现代的架构设计，提高代码可维护性

## 9. 总结

智能专注助手通过实现三个核心功能模块，为用户提供了一套简单有效的专注辅助工具。系统采用模块化设计，各功能组件可以独立运行，也可以通过整合界面统一管理。虽然目前的实现还比较基础，但已经展现了基于多模态情境感知的智能助手的潜力。未来可以通过添加更多感知能力和智能决策机制，进一步提升系统的智能化水平和用户体验。